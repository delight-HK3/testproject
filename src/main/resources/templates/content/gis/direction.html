<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default_layout}">

    <head>
        <th:block th:replace="~{content/common/headScript :: headerScriptFragment}"></th:block>

        <!-- naver Map Script -->
        <script type="text/javascript" th:src="@{${naverMap}}"></script>
        
    </head>

    <body>
        <div class="container">
            <br>
            <br>
            <div id="naverMap" style="width:100%;height:800px;"></div>

            <script>
                var mapOptions = {
                    center: new naver.maps.LatLng(37.3595704, 127.105399),
                    zoom: 10
                };
                
                var map = new naver.maps.Map('naverMap', mapOptions);

                $.ajax({
                    url: "./directionGps"
                    , type: 'GET'
                    , dataType: 'json'
                    , contentType : 'application/charset=utf-8'
                    , success: function (data) {

                        var route = data.route.trafast[0].path;
                        const path = route.map(([lng, lat]) => new naver.maps.LatLng(lat, lng));
                        
                        const polyline = new naver.maps.Polyline({
                            map: map,
                            path: path,
                            strokeColor: "#FF0000", // Route color
                            strokeWeight: 5,       // Route width
                        });

                        // Adjust the map view to fit the route
                        const bounds = new naver.maps.LatLngBounds();
                        path.forEach((point) => bounds.extend(point));
                        map.fitBounds(bounds);
                    }
                });

            </script>

            <th:block th:replace="~{content/common/footer :: footerFragment}"></th:block>
        </div>
    </body>
</html>